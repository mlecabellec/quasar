################################################################################
#                                                                              #
#                               ai64_config                                    #
#                                                                              #
# If this file is present, it will be read by the ai64_start script and used   #
# to pass a parameter string to the modprobe call. There must exist only one   #
# non-commented line in this file otherwise, the last entry will be used.      #
# The script ignores any lines that contain '#' or '*'.                        #
#                                                                              #
# The valid parameters that ai64 modprobe expects are:                         #
#                                                                              #
#------------------------------------------------------------------------------#
# resmem=<start_address>,<size>                                                #
#                                                                              #
#   Use Reserved Physical Memory: (First Method)                               #
#   =============================                                              #
#   If the resmem= option is specified and BOTH arguments <start_address> and  #
#   <size> are non-zero, the driver will extract DMA buffers from the reserved #
#   physical memory equal to the number specified by the b#= option. If the    #
#   resmem= option is specified, the user needs to first reserve physical      #
#   memory in the kernel by specifying the mem=<KERNEL TOP ADDRESS> in the     #
#   /etc/grub.conf file. e.g. specifying mem=1152M (or mem=0x48000000) in      #
#   grub.conf on a 2GB (2048MB) system will reserve 896MB (2048 - 1152) or     #
#   (0x48000000 to 0x800000000) memory to be used by drivers.                  #
#                                                                              #
#   In the above reserved physical memory example, the start address for the   #
#   resmem= command can range from kernel top (0x48000000 to end of physical   #
#   memory). The size of resmem= command can also range from a minimum of      #
#   one DMA buffer (currently set to 512K bytes or 0x80000) to all of reserved #
#   physical memory (physical memory - kernel top).                            #
#                                                                              #
#   e.g. resmem=0x48000000,0x500000  Driver uses reserved memory starting      #
#                                    at 0x48000000 for 5MBytes.                #
#                                                                              #
#   The user can also specify a start_address of '-1' which tells the driver   #
#   to find and take the top of KERNEL memory (i.e. the address as specified   #
#   by mem= in the grub.conf file). The user can also specify a size of -1. In #
#   this case the driver will take all of memory starting at start_address     #
#   specified in the resmem= option to the end of PHYSICAL memory.             #
#                                                                              #
#   WARNING! the user needs to make certain that the memory assigned to this   #
#   device must not be used by any other device driver, especially, when the   #
#   '-1' argument is used, otherwise, system integrity could be compromized.   #
#                                                                              #
#   In each of the three examples below, the driver uses reserved physical     #
#   memory from 0x48000000 to 0x800000000.                                     #
#                                                                              #
#   e.g. resmem=-1,-1                                                          #
#        resmem=0x48000000,-1                                                  #
#        resmem=-1,0x38000000                                                  #
#                                                                              #
#   Now, from this reserved memory specified by the resmem= command, the       #
#   driver can allocate a number of buffers for each card that is found, based #
#   on the b#= option.                                                         #
#                                                                              #
#   Note: The number of buffers specified in the b#= option MUST be a positive #
#   number for the driver to allocate DMA buffers from the reserved physical   #
#   memory. If the number of buffers is negative, the driver will not use the  #
#   reserved physical memory for that board but instead 'allocate' DMA buffers #
#   when the device is opened by the user.                                     #
#                                                                              #
#   The advantage for this approach (reserving physical memory) is that the    #
#   user can allocate a lot of memory up front and the driver will not run out #
#   of reserved memory as it will be assigned at the time the driver is loaded.#
#                                                                              #
#   Allocate DMA Memory: (Second Method)                                       #
#   ====================                                                       #
#   If the resmem= option is not specified, OR, if it is specified and EITHER  #
#   argument <start_address> or <size> is zero, the the driver will not use    #
#   the reserved physical memory for any of the boards, but will allocated DMA #
#   buffers (when the board is opened by the user). The number of DMA buffers  #
#   allocated will be equal to the number specified by the b#= option.         #
#                                                                              #
#   e.g. resmem=0,0                                                            #
#        resmem=0,-1                                                           #
#        resmem=-1,0                                                           #
#                                                                              #
#   Note: Regardless of the resmem= option, if the b#= option specified a      #
#   negative number for any board, the driver will allocate DMA buffer instead #
#   of using the reserved physical memory for that board. In this way, the     #
#   user can specify the resmem= option and selectively set some boards to use #
#   reserved physical memory and some board to have the driver allocate its    #
#   DMA memory.                                                                #
#                                                                              #
#   A disadvantage of this approach (allocating DMA memory) is that if the     #
#   system memory gets fragmented the driver will be unable to open the device #
#   and allocate the DMA memory until the kernel is rebooted.                  #
#                                                                              #
#   Note: If user has specified DMA buffers via this second method, they can   #
#   at any time use the ioctl calls IOCTL_AI64_REMOVE_DMA_BUFFERS,             #
#   IOCTL_AI64_GET_NUM_DMA_BUFFERS and IOCTL_AI64_ALLOCATE_DMA_BUFFERS         #
#   change or remove the DMA buffer allocation. To change buffer allocation,   #
#   the must first be removed.                                                 #
#                                                                              #
#------------------------------------------------------------------------------#
# b#=<num_of_buffers>  where '#' can go from 0 to 9 representing 10 boards     #
#                                                                              #
#   The b#= option specifies the number of DMA buffers to be used by the       #
#   driver for the specific board. The driver only uses a single buffer per    #
#   board if the user performs programmed I/O (AI64_DMA_DISABLE) or any of     #
#   standard DMA modes (AI64_DMA_ENABLE or AI64_DMA_DEMAND_MODE). If the       #
#   user selects the AI64_DMA_CONTINUOUS mode, the driver uses a chain of      #
#   DMA buffers and hence the user should specify as many as necessary so as   #
#   not to overflow the sample FIFO. The larger the number, the more tolerant  #
#   the driver is to slow reads, however, more memory is reserved. If the      #
#   resmem= option is not specifed, or if the b#= is a negative value, the     #
#   buffers are allocated dynamically by the driver at the time the device is  #
#   opened, instead of allocating them from reserved kernel memory.            #
#                                                                              #
#   If the resmem= option is specified, the sum total of all the b#= numbers   #
#   ( positive numbers only - for all the boards that are present) times the   #
#   size of each buffer (512Kbytes) cannot be greater than the available       #
#   reserved memory as specified by the resmem= size option.                   #
#                                                                              #
#   The minimum value of b#= is absolute '1'. If b#= is set to 0, then the     #
#   driver will not reserve any memory for the board and hence the user will   #
#   be unable to perform standard reads to the device. This feature (b#=0) is  #
#   only available for users who prefer to issue and handle their own DMA at   #
#   their own risk.                                                            #
#                                                                              #
#   If the b# option is not specified for a board, the driver uses a default   #
#   number of buffers. Currently, it is set to 5 DMA buffers per board.        #
#                                                                              #
#                              ***** NOTE *****                                #
#   If the driver fails to load due to an ioremap error as observed via the    #
#   'dmesg' command, the user will need to reduce the sum total of the         #
#   number_of_buffers. Alternately, the user can increase the "kernel virtual  #
#   address space reserved for vmalloc and ioremap" configuration under the    #
#   "General setup" and re-build the kernel. Each buffer is 512K bytes in size.#
#                                                                              #
#------------------------------------------------------------------------------#
# ai64_debug_mask=<debug_mask> for debug only if debugging is enabled          #
#                                                                              #
#   This option will only be valid if the driver is compiled with debugging    #
#   enabled. Only persons familiar with this driver should use this option     #
#   otherwise driver operation could be compromised. The debug_mask is a       #
#   hex value representing specific debug enabling options.                    #
#                                                                              #
#         D_ENTER         0x00000001  /* enter routine */                      #
#         D_EXIT          0x00000002  /* exit routine */                       #
#                                                                              #
#         D_L1            0x00000004  /* level 1 */                            #
#         D_L2            0x00000008  /* level 2 */                            #
#         D_L3            0x00000010  /* level 3 */                            #
#         D_L4            0x00000020  /* level 4 */                            #
#                                                                              #
#         D_ERR           0x00000040  /* level error */                        #
#         D_WAIT          0x00000080  /* level wait */                         #
#                                                                              #
#         D_INT0          0x00000100  /* interrupt level 0 */                  #
#         D_INT1          0x00000200  /* interrupt level 1 */                  #
#         D_INT2          0x00000400  /* interrupt level 2 */                  #
#         D_INT3          0x00000800  /* interrupt level 3 */                  #
#         D_INTW          0x00001000  /* interrupt wakeup level */             #
#         D_INTE          0x00002000  /* interrupt error */                    #
#                                                                              #
#         D_RTIME         0x00010000  /* display read times */                 #
#                                                                              #
#         D_REGS          0x00020000  /* dump registers */                     #
#                                                                              #
#         D_IOCTL         0x00040000  /* ioctl call */                         #
#                                                                              #
#         D_HWM           0x00080000  /* read/write HWM */                     #
#                                                                              #
#         D_TIME_BTWR     0x01000000  /* display time between reads */         #
#                                                                              #
#         D_DATA          0x00100000  /* data level */                         #
#         D_DMA           0x00200000  /* DMA level */                          #
#         D_PLX           0x00400000  /* PLX Status Diagnostic */              #
#         D_BUFF          0x00800000  /* Buffer Allocation */                  #
#                                                                              #
#  ai64_debug_mask=-1       enable all debugging - very risky                  #
#  ai64_debug_mask=0x2040   enable all error displays                          #
#                                                                              #
################################################################################

### use all of reserved memory, each board is assigned 20 buffers of 
### reserved memory (with or without debug).
### resmem=-1,-1 b0=20 b1=20 b2=20 b3=20 b4=20 ai64_debug_mask=0x01082040

### driver will try to allocate the requested buffers for each board.
### resmem=0,0 b0=5 b1=10 b2=3 b3=5 b4=5 ai64_debug_mask=0x2040
### b0=5 b1=10 b2=3 b3=5 b4=5

### driver will allocate buffers from reserved memory for boards 2 and 4.
### It will allocate buffers at open for boards 3, 5 and 6 and will not
### allocate any DMA buffers for 0 and 1.
### resmem=-1,-1 b0=0 b1=0 b2=5 b3=-3 b4=10 b5=-4 b6=-2

### driver allocates no DMA buffers for any the boards 0 - 6
### b0=0 b1=0 b2=0 b3=0 b4=0 b5=0 b6=0 

resmem=0,0 b0=3 b1=3 b2=3 b3=3 b4=3
